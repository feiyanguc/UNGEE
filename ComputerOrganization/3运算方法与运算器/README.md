## 运算方法与运算器

大纲要求

> 1. 定点机器数的运算方法
>   1. 补码定点机器数的加/减运算。
>   2. 定点机器数的乘/除运算。
>   3. 机器数的移位运算。
>   4. 运算溢出概念和判别方法。
> 1. 浮点机器数的运算方法
>   1. 浮点机器数的加/减运算。
>   2. 浮点机器数的乘/除运算方法。
> 1. 运算器的组成与功能
>   1. 加法器：串行进位加法器与并行进位加法器。
>   2. 补码加/减运算器。
>   3. 算术逻辑单元ALU：功能与结构。
>   4. 定点运算器的结构与数据通路。
>   5. 浮点运算器。
>   6. 标志寄存器。



### 内容精讲

#### 定点机器数的运算方法

##### 补码定点机器数的加/减运算

补码加减法运算特点如下：

1. 参与运算的两个操作数均是补码形式

2. 按2进制运算规则，逢二进一

3. 符号位与数值位按同样规则参与运算，符号位运算产生的进位要丢掉，结果的符号位由运算得出。

4. 补码的加减法运算依据下面公式进行。当参与运算的数是定点小数时，模M=2；当参与运算的是定点整数时，模M=2<sup>n+1</sup>。

   [A + B]<sub>补</sub> = [A]<sub>补</sub> + [B]<sub>补</sub> (mod M)

   [A - B]<sub>补</sub> = [A]<sub>补</sub> + [-B]<sub>补</sub> (mod M)

5. 补码运算结果仍为补码

例：设机器字长8位（含一位符号位），A = 15，B = 24，求[A + B]<sub>补</sub>和[A - B]<sub>补</sub>。

[A]<sub>补</sub> = 0000 1111 [B]<sub>补</sub> = 0001 1000 [-B] = 1110 1000

[A + B]<sub>补</sub> = [A]<sub>补</sub> + [B]<sub>补</sub> = 0010 0111

[A - B]<sub>补</sub> =  [A]<sub>补</sub> + [-B]<sub>补</sub> = 1111 0111



##### 定点机器数的乘/除运算

###### 定点机器数的乘法运算

- 原码一位乘法

  原码一位乘法的特点是符号位与数值位是分开的，乘积符号由两个数的符号异或形成，而乘积的数值部分则是两个数的绝对值相乘之积。

  设[X]<sub>原</sub> = x<sub>s</sub>.x<sub>1</sub>x<sub>2</sub>...x<sub>n</sub>，[Y]<sub>原</sub> = y<sub>s</sub>.y<sub>1</sub>y<sub>2</sub>…y<sub>n</sub>，则运算规则如下：

  1. 被乘数和乘数均取绝对值参与运算，符号位为x<sub>s</sub>⊕y<sub>s</sub>。
  2. 部分积的长度同被乘数，取n+1位，以便存放乘法过程中绝对值大于或等于1的值，初值为0。
  3. 从乘数的最低位y<sub>n</sub>开始判断：若y<sub>n</sub> = 1，则部分积加上被乘数|x|，然后右移一位；若y<sub>n</sub> = 0，则部分积加上0，然后右移一位。
  4. 重复步骤3，判断n次。

  因为乘积的数值部分是两个绝对值的乘积，故原码一位乘法运算过程中的右移操作均为**逻辑右移**。

  考虑到运算时可能出现绝对值大于1的情况（但此刻并不是溢出），所以部分积和被乘数取**双符号位**。

  下边举个例子：设机器字长为5位（含1位符号位，n =4），x = -0.1101，y = 0.1011，采用原码一位乘法求x · y。

- 补码一位乘法



###### 定点机器数的除法运算

- 原码除法运算



- 补码除法运算



##### 机器数的移位运算

移位运算根据操作的对象不同，分为算术移位和逻辑移位，对于有符号数的移位称为算术移位，无符号数的移位称为逻辑移位。

###### 算术移位

算术移位的对象是有符号数，移位操作后，符号位保持不变。

对于正数，移位后出现的空位均以0补齐，对于负数，原码、补码、反码移位规则如下：

- 原码：符号位不变，空位用0补齐
- 反码：符号位不变，空位用1补齐
- 补码：左移空位填0，右移空位填1



###### 逻辑移位

逻辑左移，高位丢失，低位填0；逻辑右移，低位丢失，高位填0。



##### 运算溢出概念和判别方法

溢出是指运算结果超过了数的表示范围。通常，称大于机器数所能表示的最大正数为上溢，小于机器数所能表示的最小负数为下溢。补码定点数加减运算溢出判断的方法有3种。

###### 采用一位符号位

由于减法在机器中是用加法器实现的，因此无论是加法还是减法，只要参与操作的两个数符号相同，结构与原操作数符号不同，则肯定发生了溢出。



###### 采用双符号位

双符号位法也称模4补码。运算结果的两个符号位S<sub>1</sub>S<sub>2</sub>相同，表示未溢出，不同，表示溢出，此时最高位代表真正的符号。

符号位S<sub>1</sub>S<sub>2</sub>的各种情况如下：

1. S<sub>1</sub>S<sub>2</sub> = 00：表示结果为正，无溢出
2. S<sub>1</sub>S<sub>2</sub> = 01：表示结果正溢出
3. S<sub>1</sub>S<sub>2</sub> = 10：表示结果负溢出
4. S<sub>1</sub>S<sub>2</sub> = 11：表示结果为负，无溢出

则溢出逻辑判断表达式为V = S<sub>1</sub>⊕S<sub>2</sub>，若V = 0，表示无溢出，V = 1，表示结果溢出。



###### 采用一位符号位根据数据位的进位情况判断

如果符号位的进位C<sub>s</sub>与最高位的进位C<sub>1</sub>相同，则说明没有溢出，否则发生了溢出。则溢出的逻辑判断表达式为V = C<sub>s</sub>⊕C<sub>1</sub>，若V = 0，表示无溢出；V = 1，表示有溢出。



#### 浮点机器数的运算方法

##### 浮点机器数的加/减运算



##### 浮点机器数的乘/除运算方法



#### 运算器的组成与功能

##### 加法器：串行进位加法器与并行进位加法器



##### 补码加/减运算器



#####算术逻辑单元ALU：功能与结构



##### 定点运算器的结构与数据通路



##### 浮点运算器



##### 标志寄存器



### 例题精解

#### 选择题

------

2011

--------------

【例题】判断浮点数运算是否溢出，取决于\_\_\_\_\_\_。

A. 尾数是否上溢

B. 尾数是否下溢

C. 阶码是否上溢

D. 阶码是否下溢



【例题】用2片74181可组成\_\_\_\_\_\_\_。

A. 组内串行进位，组间串行进位的8位ALU

B. 组内串行进位，组间并行进位的8位ALU

C. 组内并行进位，组间串行进位的8位ALU

D. 组内并行进位，组间并行进位的8位ALU



【例题】对于补码机器数的算数移位，方法正确的是\_\_\_\_\_\_。

A. 右移时高位补“0”，左移时低位补“0”

B. 右移时高位补“1”，左移时低位补“0”

C. 右移时高位补符号位，左移时低位补“0”

D. 右移时高位补符号位，左移时低位补符号位



【例题】在计算机内，减法一般用\_\_\_\_\_\_来实现。

A. 二进制减法器

B. 十进制减法器

C. 二进制加法器

D. 十进制加法器

---------

2012

-------------

【例题】某8位寄存器中存放了一个补码机器数DEH，则对其分别进行算术左移一位和算术右移一位，其值分别为\_\_\_\_\_\_\_\_。

A. BCH，EFH

B. EFH，BCH

C. BDH，6FH

D. 6FH，BBH



【例题】判断浮点数运算是否溢出，取决于运算结果的\_\_\_\_\_\_\_\_。

A. 尾数是否正溢出

B. 阶码是否正溢出

C. 尾数是否负溢出

D. 阶码是否负溢出



【例题】用4片74LS181和1片74LS182可组成\_\_\_\_\_\_\_。

A. 组内串行进位，组间串行进位的16位ALU

B. 组内串行进位，组间并行进位的16位ALU

C. 组内并行进位，组间串行进位的16位ALU

D. 组内并行进位，组间并行进位的16位ALU



【例题】下面关于运算器的说法中，错误的是\_\_\_\_\_\_\_。

A. 补码加法运算中，符号位和数值位一样参加运算

B. 补码的减法运算可以转化为加法来实现

C. 串行乘法运算是通过多次累加、左移来完成的，而串行除法运算是通过多次减法、右移完成的

D. 并行除法运算器通过牺牲硬件的代价来换取运算速度的提高



#### 填空题

--------

2011

----------

【例题】浮点数乘法的三个主要步骤是\_\_\_\_\_\_\_\_\_\_、\_\_\_\_\_\_\_\_\_\_、\_\_\_\_\_\_\_\_\_\_\_\_。





#### 计算分析题

------

2011

----------

【例题】已知X = -0.11011，Y = +0.10011，使用变形补码（双符号补码），求[X + Y]<sub>补</sub>和[X - Y]<sub>补</sub>，并指出运算结果是否有溢出。



--------

2018

---------

【例题】某机浮点数为16位，阶码8位，尾数8位，各含一位的符号位，均以补码表示，格式如下：

<img src="./assets/image-20180915214951704.png" width=400>

（1）将实数X按照上述格式表示为规格化浮点数，以十六进制表示为81BCH，请写出X的十进制真值。

（2）另一实数Y = 39/128，请按照上述格式将其表示为规格化浮点数，并以十六进制表示。

（3）计算上述X和Y的和[X+y]<sub>浮</sub>，模拟计算机浮点运算器，列出计算过程（用补码计算，采用0舍1入法舍入）。



### 习题精练